{"version":3,"file":"vue2mapbox-gl.js","sources":["../src/utils/propsBinder.js","../src/utils/eventsBinder.js","../src/components/v-mapbox.js","../src/components/v-mapbox-layer.js","../src/components/v-mapbox-source.js","../src/components/v-mapbox-navigation-control.js","../src/main.js"],"sourcesContent":["function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nfunction propsBinder(vueElement, mapboxElement, props) {\n    const keys = _.keys(props);\n    _.each(keys, (key, i) => {\n        const setMethodName = 'set' + capitalizeFirstLetter(key);\n        const deepValue = (props[key].type === Object);\n        vueElement.$watch(key, (newVal, oldVal) => {\n            mapboxElement[setMethodName](newVal);\n        });\n    });\n}\n\nfunction propsDefaults (props, options) {\n    return _.omitBy(\n        props,\n        (val) => {\n            // keep values that are not nil\n            return _.isNil(val);\n        }\n    );\n}\n\nexport {\n    propsBinder,\n    propsDefaults\n};\n","function bindMapEvents(vueElement, map, events) {\n  for (var i = 0; i < events.length; i++) {\n    const exposedName = 'mb-' + events[i];\n    const eventName = events[i];\n    map.on(eventName, (ev) => {\n      vueElement.$emit(exposedName, ev);\n    });\n  }\n}\n\nfunction bindLayerEvents(vueElement, map, layer, events) {\n  for (var i = 0; i < events.length; i++) {\n    const exposedName = 'mbl-' + events[i];\n    const eventName = events[i];\n    map.on(eventName, layer, (ev) => {\n      vueElement.$emit(exposedName, ev);\n    });\n  }\n}\n\nexport {\n  bindMapEvents,\n  bindLayerEvents\n};\n","import _ from 'lodash';\nimport mapboxgl from 'mapbox-gl';\nimport {propsBinder, propsDefaults} from '../utils/propsBinder.js';\nimport {bindMapEvents, bindLayerEvents} from '../utils/eventsBinder.js';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nconst mapEvents = [\n  'load',\n  'zoomstart',\n  'zoomend',\n  'zoom'\n]\n\n// props that we want to proxy\n// some are disabled pending testing\n// note that boolean props are always defined (unspecified = false).\n// The default true's are copied from https://www.mapbox.com/mapbox-gl-js/api/#map\n// these can be disabled after object construction\n// we can watch all these properties but that's disabled\nconst props = {\n  accessToken: {\n    type: String,\n    required: true\n  },\n  // always this component\n  container: {\n    type: [HTMLElement, String]\n  },\n  minZoom: {\n    type: Number\n  },\n  maxZoom: {\n    type: Number\n  },\n  // can't use style (reserved), use same approach as uber/react-map-gl\n  mapStyle: {\n    type: [Object, String]\n  },\n  // hash: {\n  //   type: Boolean,\n  //   default: false\n  // },\n  // interactive: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // bearingSnap: {\n  //   type: Number\n  // },\n  // classes: {\n  //   // array of strings\n  //   type: Array\n  // },\n  // attributionControl: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // logoPosition: {\n  //   type: String\n  // },\n  // failIfMajorPerformanceCaveat: {\n  //   type: Boolean,\n  //   default: false\n  // },\n  // preserveDrawingBuffer: {\n  //   type: Boolean,\n  //   default: false\n  // },\n  // refreshExpiredTiles: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // maxBounds: {\n  //   // latLngLike\n  //   type: [Object, Array]\n  // },\n  // scrollZoom: {\n  //   type: [Boolean, Object],\n  //   default: true\n  // },\n  // boxZoom: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // dragRotate: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // dragPan: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // keyboard: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // doubleClickZoom: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  // touchZoomRotate: {\n  //   type: [Boolean, Object],\n  //   default: true\n  // },\n  // trackResize: {\n  //   type: Boolean,\n  //   default: true\n  // },\n  center: {\n    type: [Object, Array]\n  },\n  zoom: {\n    type: Number\n  },\n  bearing: {\n    type: Number\n  },\n  pitch: {\n    type: Number\n  },\n  // renderWorldCopies: {\n  //   type: Boolean,\n  //   default: true\n  // }\n};\n\nexport default {\n  name: 'v-mapbox',\n  data () {\n    return {\n      map: null,\n      layers: []\n    };\n  },\n  props: props,\n  mounted () {\n    //Initialze Map\n    let options = {};\n    mapboxgl.accessToken = this.accessToken;\n    // renamed properties\n    if (this.mapStyle) {\n      options.style = this.mapStyle;\n    }\n    let defaults = propsDefaults(this.$props);\n    _.assign(options, defaults);\n    options.container = this.$el;\n\n    this.map = new mapboxgl.Map(options);\n    // emit a map created event\n    this.$emit('mb-created', this.map);\n    bindMapEvents(this, this.map, mapEvents);\n\n\n    // propsBinder(this, this.map, props);\n\n\n\n    this.$on('mb-load', () => {\n      _.each(\n        this.$children,\n        (child) => {\n          child.deferredMountedTo(this.map);\n          if (child.$options.name === 'v-mapbox-layer') {\n            this.layers.push(child.options);\n          }\n        }\n      );\n    });\n\n  },\n  watch: {\n    layers(old) {\n      console.log('layers changed', old);\n    }\n  },\n  methods: {\n  }\n};\n","export default {\n  name: 'v-mapbox-layer',\n  data () {\n    return {\n    };\n  },\n  props: {\n    options: {\n      default: () => {\n        return {};\n      },\n      type: Object\n    }\n  },\n  mounted () {\n  },\n  methods: {\n    deferredMountedTo(map) {\n      map.addLayer(this.options);\n    }\n  }\n};\n","import _ from 'lodash';\n\nexport default {\n  name: 'v-mapbox-source',\n  data () {\n    return {\n    };\n  },\n  props: {\n    options: {\n      default: () => {\n        return {};\n      },\n      type: Object\n    }\n  },\n  mounted () {\n  },\n  methods: {\n    deferredMountedTo(map) {\n      map.addSource(this.options.id, _.omit(this.options, ['id']));\n    }\n  }\n};\n","import mapboxgl from 'mapbox-gl';\n\nexport default {\n  name: 'v-mapbox-navigation-control',\n  data () {\n    return {\n    };\n  },\n  props: {\n    options: {\n      default: () => {\n        return {};\n      },\n      type: Object\n    }\n  },\n  mounted () {\n  },\n  methods: {\n    deferredMountedTo(map) {\n      let control = new mapboxgl.NavigationControl();\n      map.addControl(control);\n    }\n  }\n};\n","import VMapbox from './components/VMapbox.vue';\nimport VMapboxLayer from './components/VMapboxLayer.vue';\nimport VMapboxSource from './components/VMapboxSource.vue';\nimport VMapboxNavigationControl from './components/VMapboxNavigationControl.vue';\n\nfunction install(Vue, options) {\n  console.log('Installing', Vue, options);\n  Vue.component('v-mapbox', VMapbox);\n  Vue.component('v-mapbox-layer', VMapboxLayer);\n  Vue.component('v-mapbox-source', VMapboxSource);\n  Vue.component('v-mapbox-navigation-control', VMapboxNavigationControl);\n};\nexport default install;\n"],"names":["const","let","_","this","VMapbox","VMapboxLayer","VMapboxSource","VMapboxNavigationControl"],"mappings":"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"}